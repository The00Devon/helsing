gdjs.MechanicsCode = {};
gdjs.MechanicsCode.forEachIndex3 = 0;

gdjs.MechanicsCode.forEachObjects3 = [];

gdjs.MechanicsCode.forEachTemporary3 = null;

gdjs.MechanicsCode.forEachTotalCount3 = 0;

gdjs.MechanicsCode.GDSilverCountObjects1= [];
gdjs.MechanicsCode.GDSilverCountObjects2= [];
gdjs.MechanicsCode.GDSilverCountObjects3= [];
gdjs.MechanicsCode.GDSilverCountObjects4= [];
gdjs.MechanicsCode.GDDepthObjects1= [];
gdjs.MechanicsCode.GDDepthObjects2= [];
gdjs.MechanicsCode.GDDepthObjects3= [];
gdjs.MechanicsCode.GDDepthObjects4= [];
gdjs.MechanicsCode.GDForegroundObjects1= [];
gdjs.MechanicsCode.GDForegroundObjects2= [];
gdjs.MechanicsCode.GDForegroundObjects3= [];
gdjs.MechanicsCode.GDForegroundObjects4= [];
gdjs.MechanicsCode.GDMossObjects1= [];
gdjs.MechanicsCode.GDMossObjects2= [];
gdjs.MechanicsCode.GDMossObjects3= [];
gdjs.MechanicsCode.GDMossObjects4= [];
gdjs.MechanicsCode.GDGlassObjects1= [];
gdjs.MechanicsCode.GDGlassObjects2= [];
gdjs.MechanicsCode.GDGlassObjects3= [];
gdjs.MechanicsCode.GDGlassObjects4= [];
gdjs.MechanicsCode.GDLadderObjects1= [];
gdjs.MechanicsCode.GDLadderObjects2= [];
gdjs.MechanicsCode.GDLadderObjects3= [];
gdjs.MechanicsCode.GDLadderObjects4= [];
gdjs.MechanicsCode.GDDoorwayBackObjects1= [];
gdjs.MechanicsCode.GDDoorwayBackObjects2= [];
gdjs.MechanicsCode.GDDoorwayBackObjects3= [];
gdjs.MechanicsCode.GDDoorwayBackObjects4= [];
gdjs.MechanicsCode.GDDoorwayObjects1= [];
gdjs.MechanicsCode.GDDoorwayObjects2= [];
gdjs.MechanicsCode.GDDoorwayObjects3= [];
gdjs.MechanicsCode.GDDoorwayObjects4= [];
gdjs.MechanicsCode.GDDoorLightVerticalObjects1= [];
gdjs.MechanicsCode.GDDoorLightVerticalObjects2= [];
gdjs.MechanicsCode.GDDoorLightVerticalObjects3= [];
gdjs.MechanicsCode.GDDoorLightVerticalObjects4= [];
gdjs.MechanicsCode.GDDoorLightHorizontalObjects1= [];
gdjs.MechanicsCode.GDDoorLightHorizontalObjects2= [];
gdjs.MechanicsCode.GDDoorLightHorizontalObjects3= [];
gdjs.MechanicsCode.GDDoorLightHorizontalObjects4= [];
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects1= [];
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects2= [];
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects3= [];
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects4= [];
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects1= [];
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects2= [];
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects3= [];
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects4= [];
gdjs.MechanicsCode.GDCrystalObjects1= [];
gdjs.MechanicsCode.GDCrystalObjects2= [];
gdjs.MechanicsCode.GDCrystalObjects3= [];
gdjs.MechanicsCode.GDCrystalObjects4= [];
gdjs.MechanicsCode.GDButtonObjects1= [];
gdjs.MechanicsCode.GDButtonObjects2= [];
gdjs.MechanicsCode.GDButtonObjects3= [];
gdjs.MechanicsCode.GDButtonObjects4= [];
gdjs.MechanicsCode.GDDarknessObjects1= [];
gdjs.MechanicsCode.GDDarknessObjects2= [];
gdjs.MechanicsCode.GDDarknessObjects3= [];
gdjs.MechanicsCode.GDDarknessObjects4= [];
gdjs.MechanicsCode.GDSunlightSourceObjects1= [];
gdjs.MechanicsCode.GDSunlightSourceObjects2= [];
gdjs.MechanicsCode.GDSunlightSourceObjects3= [];
gdjs.MechanicsCode.GDSunlightSourceObjects4= [];
gdjs.MechanicsCode.GDSunlightObjects1= [];
gdjs.MechanicsCode.GDSunlightObjects2= [];
gdjs.MechanicsCode.GDSunlightObjects3= [];
gdjs.MechanicsCode.GDSunlightObjects4= [];
gdjs.MechanicsCode.GDMirrorStaticObjects1= [];
gdjs.MechanicsCode.GDMirrorStaticObjects2= [];
gdjs.MechanicsCode.GDMirrorStaticObjects3= [];
gdjs.MechanicsCode.GDMirrorStaticObjects4= [];
gdjs.MechanicsCode.GDMirrorObjects1= [];
gdjs.MechanicsCode.GDMirrorObjects2= [];
gdjs.MechanicsCode.GDMirrorObjects3= [];
gdjs.MechanicsCode.GDMirrorObjects4= [];
gdjs.MechanicsCode.GDSphereStaticObjects1= [];
gdjs.MechanicsCode.GDSphereStaticObjects2= [];
gdjs.MechanicsCode.GDSphereStaticObjects3= [];
gdjs.MechanicsCode.GDSphereStaticObjects4= [];
gdjs.MechanicsCode.GDSphereObjects1= [];
gdjs.MechanicsCode.GDSphereObjects2= [];
gdjs.MechanicsCode.GDSphereObjects3= [];
gdjs.MechanicsCode.GDSphereObjects4= [];
gdjs.MechanicsCode.GDPlayerObjects1= [];
gdjs.MechanicsCode.GDPlayerObjects2= [];
gdjs.MechanicsCode.GDPlayerObjects3= [];
gdjs.MechanicsCode.GDPlayerObjects4= [];
gdjs.MechanicsCode.GDSilverObjects1= [];
gdjs.MechanicsCode.GDSilverObjects2= [];
gdjs.MechanicsCode.GDSilverObjects3= [];
gdjs.MechanicsCode.GDSilverObjects4= [];
gdjs.MechanicsCode.GDVampireObjects1= [];
gdjs.MechanicsCode.GDVampireObjects2= [];
gdjs.MechanicsCode.GDVampireObjects3= [];
gdjs.MechanicsCode.GDVampireObjects4= [];
gdjs.MechanicsCode.GDleftObjects1= [];
gdjs.MechanicsCode.GDleftObjects2= [];
gdjs.MechanicsCode.GDleftObjects3= [];
gdjs.MechanicsCode.GDleftObjects4= [];
gdjs.MechanicsCode.GDrightObjects1= [];
gdjs.MechanicsCode.GDrightObjects2= [];
gdjs.MechanicsCode.GDrightObjects3= [];
gdjs.MechanicsCode.GDrightObjects4= [];

gdjs.MechanicsCode.conditionTrue_0 = {val:false};
gdjs.MechanicsCode.condition0IsTrue_0 = {val:false};
gdjs.MechanicsCode.condition1IsTrue_0 = {val:false};


gdjs.MechanicsCode.eventsList0x81572c = function(runtimeScene) {

{


{
gdjs.MechanicsCode.GDPlayerObjects2.createFrom(runtimeScene.getObjects("Player"));
{gdjs.evtTools.camera.centerCamera(runtimeScene, (gdjs.MechanicsCode.GDPlayerObjects2.length !== 0 ? gdjs.MechanicsCode.GDPlayerObjects2[0] : null), true, "", 0);
}{gdjs.evtTools.camera.centerCamera(runtimeScene, (gdjs.MechanicsCode.GDPlayerObjects2.length !== 0 ? gdjs.MechanicsCode.GDPlayerObjects2[0] : null), true, "Darkness", 0);
}}

}


{


gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.input.isKeyPressed(runtimeScene, "Escape");
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
{gdjs.evtTools.runtimeScene.replaceScene(runtimeScene, "StartMenu", false);
}}

}


{


gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.runtimeScene.sceneJustBegins(runtimeScene);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
gdjs.MechanicsCode.GDGlassObjects1.createFrom(runtimeScene.getObjects("Glass"));
gdjs.MechanicsCode.GDPlayerObjects1.createFrom(runtimeScene.getObjects("Player"));
gdjs.MechanicsCode.GDSphereObjects1.createFrom(runtimeScene.getObjects("Sphere"));
gdjs.MechanicsCode.GDSphereStaticObjects1.createFrom(runtimeScene.getObjects("SphereStatic"));
gdjs.MechanicsCode.GDleftObjects1.createFrom(runtimeScene.getObjects("left"));
gdjs.MechanicsCode.GDrightObjects1.createFrom(runtimeScene.getObjects("right"));
{for(var i = 0, len = gdjs.MechanicsCode.GDleftObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDleftObjects1[i].setOpacity(0);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDrightObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDrightObjects1[i].setOpacity(0);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDGlassObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDGlassObjects1[i].setOpacity(100);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDSphereObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDSphereObjects1[i].setOpacity(150);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDSphereStaticObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDSphereStaticObjects1[i].setOpacity(150);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects1[i].resetTimer("MirrorInteraction");
}
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x81572c
gdjs.MechanicsCode.eventsList0x797eec = function(runtimeScene) {

{

gdjs.MechanicsCode.GDPlayerObjects3.createFrom(runtimeScene.getObjects("Player"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
for(var i = 0, k = 0, l = gdjs.MechanicsCode.GDPlayerObjects3.length;i<l;++i) {
    if ( gdjs.MechanicsCode.GDPlayerObjects3[i].getBehavior("PlatformerObject").isOnLadder() ) {
        gdjs.MechanicsCode.condition0IsTrue_0.val = true;
        gdjs.MechanicsCode.GDPlayerObjects3[k] = gdjs.MechanicsCode.GDPlayerObjects3[i];
        ++k;
    }
}
gdjs.MechanicsCode.GDPlayerObjects3.length = k;}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDPlayerObjects3 */
{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects3.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects3[i].getBehavior("PlatformerObject").simulateUpKey();
}
}}

}


{

gdjs.MechanicsCode.GDPlayerObjects2.createFrom(runtimeScene.getObjects("Player"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
for(var i = 0, k = 0, l = gdjs.MechanicsCode.GDPlayerObjects2.length;i<l;++i) {
    if ( !(gdjs.MechanicsCode.GDPlayerObjects2[i].getBehavior("PlatformerObject").isOnLadder()) ) {
        gdjs.MechanicsCode.condition0IsTrue_0.val = true;
        gdjs.MechanicsCode.GDPlayerObjects2[k] = gdjs.MechanicsCode.GDPlayerObjects2[i];
        ++k;
    }
}
gdjs.MechanicsCode.GDPlayerObjects2.length = k;}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDPlayerObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects2[i].getBehavior("PlatformerObject").simulateLadderKey();
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects2[i].getBehavior("PlatformerObject").simulateJumpKey();
}
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x797eec
gdjs.MechanicsCode.eventsList0x815f04 = function(runtimeScene) {

{


gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.input.isKeyPressed(runtimeScene, "a");
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
gdjs.MechanicsCode.GDPlayerObjects2.createFrom(runtimeScene.getObjects("Player"));
{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects2[i].getBehavior("PlatformerObject").simulateLeftKey();
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects2[i].setAnimation(1);
}
}}

}


{


gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.input.isKeyPressed(runtimeScene, "d");
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
gdjs.MechanicsCode.GDPlayerObjects2.createFrom(runtimeScene.getObjects("Player"));
{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects2[i].getBehavior("PlatformerObject").simulateRightKey();
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects2[i].setAnimation(0);
}
}}

}


{


gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.input.isKeyPressed(runtimeScene, "Space");
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {

{ //Subevents
gdjs.MechanicsCode.eventsList0x797eec(runtimeScene);} //End of subevents
}

}


{


gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = !(gdjs.evtTools.input.isKeyPressed(runtimeScene, "Space"));
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
gdjs.MechanicsCode.GDPlayerObjects1.createFrom(runtimeScene.getObjects("Player"));
{for(var i = 0, len = gdjs.MechanicsCode.GDPlayerObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDPlayerObjects1[i].getBehavior("PlatformerObject").simulateDownKey();
}
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x815f04
gdjs.MechanicsCode.userFunc0x6d2f68 = function(runtimeScene) {
"use strict";


// clear old light
const pastLight = runtimeScene.getObjects("Sunlight");
for(let i=0;i<pastLight.length;i++){
    pastLight[i].deleteFromScene(runtimeScene);
}

// collect relevant objects
const sources = runtimeScene.getObjects("SunlightSource");
const mirrors = runtimeScene.getObjects("Mirror");
const mirrors2 = runtimeScene.getObjects("MirrorStatic");
const ground = runtimeScene.getObjects("Foreground");
const doors1 = runtimeScene.getObjects("DoorLightVertical");
const doors2 = runtimeScene.getObjects("DoorLightHorizontal");
const doors3 = runtimeScene.getObjects("DoorHeavyVertical");
const doors4 = runtimeScene.getObjects("DoorHeavyHorizontal");

const spheres = runtimeScene.getObjects("Sphere");
const spheres2 = runtimeScene.getObjects("SphereStatic");


// compile collidables into an array
let baseDistances = [...ground, ...mirrors, ...mirrors2, ...doors1, ...doors2, ...doors3, ...doors4];
let baseSpheres = [...spheres, ...spheres2];

// sunlight calculation function (xCoord and yCoord of beam source, angle of beam, index of reflection surface (if a reflection))
function beamFunction(x, y, angle, index){
	
    // max distance of beam
	let farthestX = x + (3000000*Math.sin(angle * Math.PI / 180));
	let farthestY = y - (3000000*Math.cos(angle * Math.PI / 180));
		
    // copy array of all collidable objects
    let distances = baseDistances.slice();
	
    // setup to find closest distance (must all be seperate)
    let closestHit = null;
    let closestHitIndex = null;
    let closestSqDist = Math.pow(x-farthestX,2)+Math.pow(y-farthestY,2);
    let closestX = farthestX;
    let closestY = farthestY;
	
	// for each collidable object
    for(let j=0;j<distances.length;j++){

        // make sure it's not directly reflecting off the surface we're testing AND surface is visible
        if(index !== j && !distances[j].isHidden()){

            // do raycast check from current source block
            let raycast = distances[j].raycastTest(x,y,farthestX,farthestY);

            // see if it's the closest object in the path
            if(raycast.collision && (raycast.closeSqDist < closestSqDist)){

                // new closest collision
                closestHit = distances[j];
                closestHitIndex = j;
                closestSqDist = raycast.closeSqDist;
                closestX = raycast.closeX;
                closestY = raycast.closeY;
            
            }

        }
        
    }
	
    // now that we have the location of the collision point, calc the distance to it
    let beamLength = Math.sqrt(closestSqDist);

    // make sunlight sprite between source and closest hit (needs updating for angles)
    let newSunlight = runtimeScene.createObject("Sunlight");
    /** @type {gdjs.SpriteRuntimeObject} */
    let newSunlightSprite = newSunlight;
    newSunlight.setAngle(angle);
    newSunlightSprite.setHeight(beamLength);
    newSunlight.setPosition( (x+(beamLength * 0.5 * Math.sin(angle * Math.PI / 180))) , (y - (beamLength * 0.5 * (1 + Math.cos(angle * Math.PI / 180)))) );

    // copy array of all sphere objects
    let allSpheres = baseSpheres.slice();

    // for each sphere
    for(let i=0; i<allSpheres.length; i++){
        
        // make sure it's not directly reflecting off the surface we're testing AND surface is visible
        if(index !== distances.length+i && !allSpheres[i].isHidden()){

            // do raycast check from current source block
            let raycast = allSpheres[i].raycastTest(x,y,farthestX,farthestY);

            // see if it's the closest object in the path
            if(raycast.collision && (raycast.closeSqDist < closestSqDist)){

                // calculate reflection angle (i have no fucking idea how i managed to come up with this)
                let reflectionAngle = angle + (((allSpheres[i].angle % 180) - angle) * 2) % 360;

                // make a new beam
                beamFunction(raycast.closeX, raycast.closeY, reflectionAngle, distances.length+i);
                
            }

        }

    }

    // if final collision is a mirror
	if(closestHit && (closestHit.name=="Mirror" || closestHit.name=="MirrorStatic")){

		// calculate reflection angle (i have no fucking idea how i managed to come up with this)
        let reflectionAngle = angle + (((closestHit.angle % 180) - angle) * 2) % 360;

		// make a new beam
		beamFunction(closestX, closestY, reflectionAngle, closestHitIndex);

    }
	
	
}

// run through each light source block
for(let i=0;i<sources.length;i++){
	
    // sunlight source info
    let source = sources[i];

    // begin recursive beam creation
	beamFunction(source.getX(), source.getY(), source.getAngle());
	
}

};
gdjs.MechanicsCode.eventsList0x6d2ee4 = function(runtimeScene) {

{


gdjs.MechanicsCode.userFunc0x6d2f68(runtimeScene);

}


}; //End of gdjs.MechanicsCode.eventsList0x6d2ee4
gdjs.MechanicsCode.userFunc0x6d3118 = function(runtimeScene) {
"use strict";

//let height = runtimeScene.getGame()._gameResolutionHeight;
let height = runtimeScene.getGame()._renderer._currentHeight || runtimeScene.getGame()._gameResolutionHeight;
//let width = runtimeScene.getGame()._gameResolutionWidth;
let width = runtimeScene.getGame()._renderer._currentWidth || runtimeScene.getGame()._gameResolutionWidth;

if (runtimeScene.getTimeManager().isFirstFrame()) {

    for (let i=0;i<height*width*0.0025;i++){

        let darkObj = runtimeScene.createObject("Darkness");
        darkObj.setLayer("Darkness");

        /** @type {gdjs.SpriteRuntimeObject} */
        let darkSprite = darkObj;
        darkSprite.setHeight(21);
        darkSprite.setWidth(21);

    }

}

const darknessInstances = runtimeScene.getObjects("Darkness");
const glowInstances = runtimeScene.getObjects("Sunlight");
const exitInstances = runtimeScene.getObjects("Doorway");

/** @type {gdjs.Layer} */
const darknessLayer = runtimeScene.getLayer("Darkness");

// size of grid
const down = height*0.05;
const across = width*0.05;

// camera coords
let cameraX = darknessLayer.getCameraX();
let cameraY = darknessLayer.getCameraY();

// seperately used for depth calc - ignore
runtimeScene._variables._variables.items.TempDepth._value = Math.floor(cameraY);

// for each dark instance within the grid
let i = 0;
while (i<(down*across)){

    // get dark sprite
    const darkObj = darknessInstances[i];
    /** @type {gdjs.SpriteRuntimeObject} */
    const darkSprite = darknessInstances[i];

    // check that there is a dark object to manipulate
    if(darkObj){

        // figure out coord of square from location in array
        let x = i%across;
        let y = Math.floor(i/across);

        // position around camera to create illusion of static layer
        darkSprite.setX(cameraX - (width*0.5) + (20*x));
        darkSprite.setY(cameraY - (height*0.5) + (20*y));

        // mark if colliding with glowing object
        darkObj.customCollision = false
        for(let j=0;j<glowInstances.length;j++){
            darkObj.customCollision = gdjs.RuntimeObject.collisionTest(darkObj, glowInstances[j]) || darkObj.customCollision;
        }


    }

    i++
}

// takes coords and returns if the dark square is colliding with light
function xy(x,y){
    return ((y<across)&&(y>=0)) ? darknessInstances[(x*across)+y] && darknessInstances[(x*across)+y].customCollision : false;
}
// set of fuctions to "scan" reflective interval distances around dark square
// for both same or one zero (if there is zero, it must be y)
function main4(x,y,x1,y1){
    return  (xy(x+x1,y+y1)) ||
            (xy(x-x1,y+y1)) ||
            (xy(x+y1,y+x1)) ||
            (xy(x+y1,y-x1));
}
// for all other combinations
function all8(x,y,x1,y1){
    return  (xy(x+x1,y-y1)) ||
            (xy(x-x1,y-y1)) ||
            (xy(x-y1,y+x1)) ||
            (xy(x-y1,y-x1)) || 
            main4(x,y,x1,y1);
}

// for each dark instance within the grid
i = 0;
while (i<(down*across)){

	// get dark sprite
    const darkObj = darknessInstances[i];
    /** @type {gdjs.SpriteRuntimeObject} */
    const darkSprite = darknessInstances[i];

    // check that there is a dark object to manipulate
    if(darkObj){

        // figure out coord of square from location in array
        let y = i%across;
        let x = Math.floor(i/across);

        // default is full darkness
        let opacity = 255;

        // UGLY FUCK FUNCTION hardcoded square floating point distance calculations
        if(darkObj.customCollision===true){    
            opacity = 0;
        } else if(main4(x,y,1,0)){
            opacity = 20;
        } else if(main4(x,y,1,1)){
            opacity = 28;
        } else if(main4(x,y,2,0)){
            opacity = 40;
        } else if(all8(x,y,2,1)){
            opacity = 45;
        } else if(main4(x,y,2,2)){
            opacity = 57;
        } else if(main4(x,y,3,0)){
            opacity = 60;
        } else if(all8(x,y,3,1)){
            opacity = 63;
        } else if(all8(x,y,3,2)){
            opacity = 72;
        } else if(main4(x,y,4,0)){
            opacity = 80;
        } else if(all8(x,y,4,1)){
            opacity = 82;
        } else if(main4(x,y,3,3)){
            opacity = 85;
        } else if(all8(x,y,4,2)){
            opacity = 89;
        } else if(main4(x,y,5,0) || all8(x,y,4,3)){
            opacity = 100;
        } else if(all8(x,y,5,1)){
            opacity = 102;
        } else if(all8(x,y,5,2)){
            opacity = 108;
        } else if(main4(x,y,4,4)){
            opacity = 113;
        } else if(all8(x,y,5,3)){
            opacity = 117;
        } else if(main4(x,y,6,0)){
            opacity = 120;
        } else if(all8(x,y,6,1)){
            opacity = 122;
        } else if(all8(x,y,6,2)){
            opacity = 126;
        } else if(all8(x,y,5,4)){
            opacity = 128;
        } else if(all8(x,y,6,3)){
            opacity = 134;
        } else if(main4(x,y,7,0)){
            opacity = 140;
        } else if(main4(x,y,5,5) || all8(x,y,7,2)){
            opacity = 141;
        } else if(all8(x,y,6,4)){
            opacity = 144;
        } else if(all8(x,y,7,2)){
            opacity = 146;
        } else if(all8(x,y,7,3)){
            opacity = 152;
        } else if(all8(x,y,6,5)){
            opacity = 156;
        } else if(main4(x,y,8,0)){
            opacity = 160;
        } else if(all8(x,y,8,1) || all8(x,y,7,4)){
            opacity = 161;
        } else if(all8(x,y,8,2)){
            opacity = 165;
        } else if(main4(x,y,6,6)){
            opacity = 170;
        } else if(all8(x,y,8,3)){
            opacity = 171;
        } else if(all8(x,y,7,5)){
            opacity = 172;
        } else if(all8(x,y,8,4)){
            opacity = 179;
        } else if(main4(x,y,9,0)){
            opacity = 180;
        } else if(all8(x,y,9,1)){
            opacity = 181;
        }
        
        // set opacity
        darkSprite.setOpacity(opacity * 1.4);

    }

    i++
}


};
gdjs.MechanicsCode.eventsList0x6d3094 = function(runtimeScene) {

{


gdjs.MechanicsCode.userFunc0x6d3118(runtimeScene);

}


}; //End of gdjs.MechanicsCode.eventsList0x6d3094
gdjs.MechanicsCode.userFunc0x6d31d0 = function(runtimeScene) {
"use strict";


const players = runtimeScene.getObjects("Player");
const mirrors = runtimeScene.getObjects("Mirror");
const spheres = runtimeScene.getObjects("Sphere");

let player = players[0];
/** @type {gdjs.SpriteRuntimeObject} */
let playerSprite = player;

let closest = null;
/** @type {gdjs.SpriteRuntimeObject} */
let closestSprite = null;
let closestDistance = 1500;

let firstHeld = null;
/** @type {gdjs.SpriteRuntimeObject} */
let firstHeldSprite = null;

let train = 0;

for(let i=0;i<[...mirrors, ...spheres].length;i++){

    //let mirror = i<mirrors.length ? mirrors[i] : spheres[i-mirrors.length];
    let mirror = [...mirrors, ...spheres][i];
    /** @type {gdjs.SpriteRuntimeObject} */
    let mirrorSprite = mirror;

    if(mirror._variables._variables.items.Held._value > 0){

        if(train===0){
            mirror.hide(false);//temp?
            firstHeld = mirror;
            firstHeldSprite = mirrorSprite;
            mirror.setX(player.getX()+11);
            mirror.setY(player.getY());
            train++
        }else{
            mirror.hide(true);//temp?
            //mirror.addForceTowardPosition((playerSprite.getAnimation() ? player.getDrawableX() + 28 + (10*train++) : player.getDrawableX() - (10*train++)), player.getDrawableY()+23, 10, 0.0001);
        }


    } else {

        let distance = mirror.getSqDistanceToObject(player);

        if(distance<closestDistance){
            
            closestDistance = distance;
            closest = mirror;
            closestSprite = mirrorSprite;

        }

    }

    mirrorSprite.setAnimation(0);

}

if(closest!==null){

    closestSprite.setAnimation(1);

    if (runtimeScene.getGame().getInputManager().isKeyPressed(69/*e*/) && player.timerElapsedTime("MirrorInteraction", 0.5)) {
        player.resetTimer("MirrorInteraction");

        closest._variables._variables.items.Held._value = 1;
    } 
    if (runtimeScene.getGame().getInputManager().isKeyPressed(79/*o*/)) {
        closestSprite.setAngle(closestSprite.getAngle()+0.5);
    } 
    if (runtimeScene.getGame().getInputManager().isKeyPressed(73/*i*/)) {
        closestSprite.setAngle(closestSprite.getAngle()-0.5);
    } 

} else if(firstHeld!==null){
    
    firstHeldSprite.setAnimation(1);

    if (runtimeScene.getGame().getInputManager().isKeyPressed(69/*e*/) && player.timerElapsedTime("MirrorInteraction", 0.5)) {
        player.resetTimer("MirrorInteraction");
        
        firstHeld.clearForces();
        firstHeld.setX(player.getX()+11);
        firstHeld.setY(player.getY());
        firstHeld._variables._variables.items.Held._value = 0;
    }
    if (runtimeScene.getGame().getInputManager().isKeyPressed(79/*o*/)) {
        firstHeldSprite.setAngle(firstHeldSprite.getAngle()+0.5);
    } 
    if (runtimeScene.getGame().getInputManager().isKeyPressed(73/*i*/)) {
        firstHeldSprite.setAngle(firstHeldSprite.getAngle()-0.5);
    }

}
};
gdjs.MechanicsCode.eventsList0x6c4b64 = function(runtimeScene) {

{


gdjs.MechanicsCode.userFunc0x6d31d0(runtimeScene);

}


}; //End of gdjs.MechanicsCode.eventsList0x6c4b64
gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDPlayerObjects2Objects = Hashtable.newFrom({"Player": gdjs.MechanicsCode.GDPlayerObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSilverObjects2Objects = Hashtable.newFrom({"Silver": gdjs.MechanicsCode.GDSilverObjects2});gdjs.MechanicsCode.eventsList0x78cd4c = function(runtimeScene) {

}; //End of gdjs.MechanicsCode.eventsList0x78cd4c
gdjs.MechanicsCode.eventsList0x78cbec = function(runtimeScene) {

{

/* Reuse gdjs.MechanicsCode.GDSilverObjects2 */

for(gdjs.MechanicsCode.forEachIndex3 = 0;gdjs.MechanicsCode.forEachIndex3 < gdjs.MechanicsCode.GDSilverObjects2.length;++gdjs.MechanicsCode.forEachIndex3) {
gdjs.MechanicsCode.GDSilverObjects3.length = 0;


gdjs.MechanicsCode.forEachTemporary3 = gdjs.MechanicsCode.GDSilverObjects2[gdjs.MechanicsCode.forEachIndex3];
gdjs.MechanicsCode.GDSilverObjects3.push(gdjs.MechanicsCode.forEachTemporary3);
if (true) {
{for(var i = 0, len = gdjs.MechanicsCode.GDSilverObjects3.length ;i < len;++i) {
    gdjs.MechanicsCode.GDSilverObjects3[i].deleteFromScene(runtimeScene);
}
}{runtimeScene.getGame().getVariables().getFromIndex(0).add(1);
}}
}

}


}; //End of gdjs.MechanicsCode.eventsList0x78cbec
gdjs.MechanicsCode.eventsList0x78cb1c = function(runtimeScene) {

{

gdjs.MechanicsCode.GDPlayerObjects2.createFrom(runtimeScene.getObjects("Player"));
gdjs.MechanicsCode.GDSilverObjects2.createFrom(runtimeScene.getObjects("Silver"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDPlayerObjects2Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSilverObjects2Objects, false, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {

{ //Subevents
gdjs.MechanicsCode.eventsList0x78cbec(runtimeScene);} //End of subevents
}

}


{


{
gdjs.MechanicsCode.GDSilverCountObjects1.createFrom(runtimeScene.getObjects("SilverCount"));
{for(var i = 0, len = gdjs.MechanicsCode.GDSilverCountObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDSilverCountObjects1[i].setString("Silver : " + gdjs.evtTools.common.toString(gdjs.evtTools.common.getVariableNumber(runtimeScene.getGame().getVariables().getFromIndex(0))));
}
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x78cb1c
gdjs.MechanicsCode.eventsList0x6a9d74 = function(runtimeScene) {

{


{
gdjs.MechanicsCode.GDDepthObjects1.createFrom(runtimeScene.getObjects("Depth"));
{for(var i = 0, len = gdjs.MechanicsCode.GDDepthObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDDepthObjects1[i].setString("Depth : " + gdjs.evtTools.common.toString((gdjs.evtTools.common.getVariableNumber(runtimeScene.getVariables().get("TempDepth")) - gdjs.evtTools.common.getVariableNumber(runtimeScene.getVariables().get("StartDepth"))) / 25));
}
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x6a9d74
gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects = Hashtable.newFrom({"Vampire": gdjs.MechanicsCode.GDVampireObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDrightObjects2Objects = Hashtable.newFrom({"right": gdjs.MechanicsCode.GDrightObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects = Hashtable.newFrom({"Vampire": gdjs.MechanicsCode.GDVampireObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDleftObjects2Objects = Hashtable.newFrom({"left": gdjs.MechanicsCode.GDleftObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects = Hashtable.newFrom({"Vampire": gdjs.MechanicsCode.GDVampireObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects = Hashtable.newFrom({"Sunlight": gdjs.MechanicsCode.GDSunlightObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects = Hashtable.newFrom({"Vampire": gdjs.MechanicsCode.GDVampireObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects = Hashtable.newFrom({"Sunlight": gdjs.MechanicsCode.GDSunlightObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDPlayerObjects1Objects = Hashtable.newFrom({"Player": gdjs.MechanicsCode.GDPlayerObjects1});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects1Objects = Hashtable.newFrom({"Vampire": gdjs.MechanicsCode.GDVampireObjects1});gdjs.MechanicsCode.eventsList0x6aa01c = function(runtimeScene) {

{

gdjs.MechanicsCode.GDVampireObjects2.createFrom(runtimeScene.getObjects("Vampire"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
for(var i = 0, k = 0, l = gdjs.MechanicsCode.GDVampireObjects2.length;i<l;++i) {
    if ( gdjs.MechanicsCode.GDVampireObjects2[i].getVariableString(gdjs.MechanicsCode.GDVampireObjects2[i].getVariables().getFromIndex(0)) == "right" ) {
        gdjs.MechanicsCode.condition0IsTrue_0.val = true;
        gdjs.MechanicsCode.GDVampireObjects2[k] = gdjs.MechanicsCode.GDVampireObjects2[i];
        ++k;
    }
}
gdjs.MechanicsCode.GDVampireObjects2.length = k;}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDVampireObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].addPolarForce(0, 100, 0);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].flipX(false);
}
}}

}


{

gdjs.MechanicsCode.GDVampireObjects2.createFrom(runtimeScene.getObjects("Vampire"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
for(var i = 0, k = 0, l = gdjs.MechanicsCode.GDVampireObjects2.length;i<l;++i) {
    if ( gdjs.MechanicsCode.GDVampireObjects2[i].getVariableString(gdjs.MechanicsCode.GDVampireObjects2[i].getVariables().getFromIndex(0)) == "left" ) {
        gdjs.MechanicsCode.condition0IsTrue_0.val = true;
        gdjs.MechanicsCode.GDVampireObjects2[k] = gdjs.MechanicsCode.GDVampireObjects2[i];
        ++k;
    }
}
gdjs.MechanicsCode.GDVampireObjects2.length = k;}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDVampireObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].addPolarForce(180, 100, 0);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].flipX(true);
}
}}

}


{

gdjs.MechanicsCode.GDVampireObjects2.createFrom(runtimeScene.getObjects("Vampire"));
gdjs.MechanicsCode.GDrightObjects2.createFrom(runtimeScene.getObjects("right"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDrightObjects2Objects, false, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDVampireObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].returnVariable(gdjs.MechanicsCode.GDVampireObjects2[i].getVariables().getFromIndex(0)).setString("right");
}
}}

}


{

gdjs.MechanicsCode.GDVampireObjects2.createFrom(runtimeScene.getObjects("Vampire"));
gdjs.MechanicsCode.GDleftObjects2.createFrom(runtimeScene.getObjects("left"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDleftObjects2Objects, false, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDVampireObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].returnVariable(gdjs.MechanicsCode.GDVampireObjects2[i].getVariables().getFromIndex(0)).setString("left");
}
}}

}


{

gdjs.MechanicsCode.GDSunlightObjects2.createFrom(runtimeScene.getObjects("Sunlight"));
gdjs.MechanicsCode.GDVampireObjects2.createFrom(runtimeScene.getObjects("Vampire"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects, false, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDVampireObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].setAnimation(1);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].unpauseTimer("Burn");
}
}}

}


{

gdjs.MechanicsCode.GDSunlightObjects2.createFrom(runtimeScene.getObjects("Sunlight"));
gdjs.MechanicsCode.GDVampireObjects2.createFrom(runtimeScene.getObjects("Vampire"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects2Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects, true, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDVampireObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].setAnimation(0);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].resetTimer("Burn");
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].pauseTimer("Burn");
}
}}

}


{

gdjs.MechanicsCode.GDVampireObjects2.createFrom(runtimeScene.getObjects("Vampire"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
for(var i = 0, k = 0, l = gdjs.MechanicsCode.GDVampireObjects2.length;i<l;++i) {
    if ( gdjs.MechanicsCode.GDVampireObjects2[i].timerElapsedTime("Burn", 2) ) {
        gdjs.MechanicsCode.condition0IsTrue_0.val = true;
        gdjs.MechanicsCode.GDVampireObjects2[k] = gdjs.MechanicsCode.GDVampireObjects2[i];
        ++k;
    }
}
gdjs.MechanicsCode.GDVampireObjects2.length = k;}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDVampireObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDVampireObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDVampireObjects2[i].deleteFromScene(runtimeScene);
}
}}

}


{

gdjs.MechanicsCode.GDPlayerObjects1.createFrom(runtimeScene.getObjects("Player"));
gdjs.MechanicsCode.GDVampireObjects1.createFrom(runtimeScene.getObjects("Vampire"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDPlayerObjects1Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDVampireObjects1Objects, false, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
{gdjs.evtTools.runtimeScene.replaceScene(runtimeScene, "DeathMenu", false);
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x6aa01c
gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDMossObjects2Objects = Hashtable.newFrom({"Moss": gdjs.MechanicsCode.GDMossObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects = Hashtable.newFrom({"Sunlight": gdjs.MechanicsCode.GDSunlightObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDMossObjects1Objects = Hashtable.newFrom({"Moss": gdjs.MechanicsCode.GDMossObjects1});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects1Objects = Hashtable.newFrom({"Sunlight": gdjs.MechanicsCode.GDSunlightObjects1});gdjs.MechanicsCode.eventsList0x6bfdc4 = function(runtimeScene) {

{

gdjs.MechanicsCode.GDMossObjects2.createFrom(runtimeScene.getObjects("Moss"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
for(var i = 0, k = 0, l = gdjs.MechanicsCode.GDMossObjects2.length;i<l;++i) {
    if ( gdjs.MechanicsCode.GDMossObjects2[i].timerElapsedTime("Burn", 2) ) {
        gdjs.MechanicsCode.condition0IsTrue_0.val = true;
        gdjs.MechanicsCode.GDMossObjects2[k] = gdjs.MechanicsCode.GDMossObjects2[i];
        ++k;
    }
}
gdjs.MechanicsCode.GDMossObjects2.length = k;}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDMossObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDMossObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDMossObjects2[i].deleteFromScene(runtimeScene);
}
}}

}


{

gdjs.MechanicsCode.GDMossObjects2.createFrom(runtimeScene.getObjects("Moss"));
gdjs.MechanicsCode.GDSunlightObjects2.createFrom(runtimeScene.getObjects("Sunlight"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDMossObjects2Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects, false, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDMossObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDMossObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDMossObjects2[i].setAnimation(1);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDMossObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDMossObjects2[i].unpauseTimer("Burn");
}
}}

}


{

gdjs.MechanicsCode.GDMossObjects1.createFrom(runtimeScene.getObjects("Moss"));
gdjs.MechanicsCode.GDSunlightObjects1.createFrom(runtimeScene.getObjects("Sunlight"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDMossObjects1Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects1Objects, true, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDMossObjects1 */
{for(var i = 0, len = gdjs.MechanicsCode.GDMossObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDMossObjects1[i].setAnimation(0);
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDMossObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDMossObjects1[i].resetTimer("Burn");
}
}{for(var i = 0, len = gdjs.MechanicsCode.GDMossObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDMossObjects1[i].pauseTimer("Burn");
}
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x6bfdc4
gdjs.MechanicsCode.userFunc0x75e758 = function(runtimeScene) {
"use strict";

const crystals = runtimeScene.getObjects("Crystal");
const sunlight = runtimeScene.getObjects("Sunlight");

for(let i=0;i<crystals.length;i++){

    let crystalObj = crystals[i];
    /** @type {gdjs.SpriteRuntimeObject} */
    let crystalSprite = crystals[i];

    let collision = false;
    for(let j=0;j<sunlight.length;j++){
        collision = gdjs.RuntimeObject.collisionTest(crystalObj, sunlight[j]) || collision;
    }
    crystalSprite.setAnimation(collision ? 1 : 0);

}

const buttons = runtimeScene.getObjects("Button");
const player = runtimeScene.getObjects("Player");

for(let i=0;i<buttons.length;i++){

    let buttonObj = buttons[i];
    /** @type {gdjs.SpriteRuntimeObject} */
    let buttonSprite = buttons[i];

    buttonSprite.setAnimation(gdjs.RuntimeObject.collisionTest(buttonObj, player[0]) ? 1 : 0);

}
};
gdjs.MechanicsCode.eventsList0x75e6d4 = function(runtimeScene) {

{


gdjs.MechanicsCode.userFunc0x75e758(runtimeScene);

}


}; //End of gdjs.MechanicsCode.eventsList0x75e6d4
gdjs.MechanicsCode.userFunc0x75ec08 = function(runtimeScene) {
"use strict";
let doorArray = [
    ...runtimeScene.getObjects("DoorLightVertical").map(door=>({door: door, light: true, vertical: true})),
    ...runtimeScene.getObjects("DoorLightHorizontal").map(door=>({door: door, light: true, vertical: false})),
    ...runtimeScene.getObjects("DoorHeavyVertical").map(door=>({door: door, light: false, vertical: true})),
    ...runtimeScene.getObjects("DoorHeavyHorizontal").map(door=>({door: door, light: false, vertical: false}))
];
let doorMap = [];
for(let i=0; i<doorArray.length; i++){
    let doorObj = doorArray[i];
    let n = doorObj.door._variables._variables.items.link._value;
    if(doorMap[n]&&doorMap[n].length){
        doorMap[n].push(doorObj);
    }else{
        doorMap[n] = [doorObj];
    }
}
/*
{
    door: obj,
    light: bool,
    vertical: bool
}
*/

/*
let sortedActivators = [
    ...runtimeScene.getObjects("Crystal"),
    ...runtimeScene.getObjects("Button")
].sort((a,b)=>a._variables._variables.items.link._value-b._variables._variables.items.link._value);
*/

let activatorArray = [
    ...runtimeScene.getObjects("Crystal"),
    ...runtimeScene.getObjects("Button")
];
let activatorMap = [];
for(let i=0; i<activatorArray.length; i++){
    let activatorObj = activatorArray[i];
    let n = activatorObj._variables._variables.items.link._value;
    if(activatorMap[n]&&activatorMap[n].length){
        activatorMap[n].push(activatorObj);
    }else{
        activatorMap[n] = [activatorObj];
    }
}

console.log("Test");
console.log(doorMap);
console.log(activatorMap);

let max = activatorMap.length > doorMap.length ? activatorMap.length : doorMap.length;

for(let i=0; i<max; i++){
    if(activatorMap[i] && activatorMap[i].length && doorMap[i] && doorMap[i].length){

        let activated = false;

        for(let j=0; j<activatorMap[i].length; j++){

            /** @type {gdjs.SpriteRuntimeObject} */
            let activatorSprite = activatorMap[i][j];

            activated = activatorSprite.getAnimation()>0 ? true : activated;

        }

        for(let j=0; j<doorMap[i].length; j++){
        
            let door = doorMap[i][j];
            let doorLength = door.vertical ? door.door.getHeight() : door.door.getWidth();

            if(activated && doorLength>5){
                
                door.vertical ? door.door.setHeight(doorLength-1) : door.door.setWidth(doorLength-1);

            }else if(!door.light && doorLength<75){

                door.vertical ? door.door.setHeight(doorLength+3) : door.door.setWidth(doorLength+3);

            }
        }

    }
}

/*
for(let i=0; i<sortedActivators.length; i++){
    let activator = sortedActivators[i];
    /** @type {gdjs.SpriteRuntimeObject} *
    let activatorSprite = sortedActivators[i];
    if(activator){
        let link = activator._variables._variables.items.link._value;
        if(link&&doorMap[link]&&doorMap[link].length){
            for(let j=0; j<doorMap[link].length; j++){

                let door = doorMap[link][j];
                let doorLength = door.vertical ? door.door.getHeight() : door.door.getWidth();

                if(activatorSprite.getAnimation()>0 && doorLength>5){
                    
                    door.vertical ? door.door.setHeight(doorLength-1) : door.door.setWidth(doorLength-1);

                }else if(!door.light && doorLength<75){

                    door.vertical ? door.door.setHeight(doorLength+3) : door.door.setWidth(doorLength+3);

                }

            }
        }
    }
}
*/
};
gdjs.MechanicsCode.eventsList0x75eb84 = function(runtimeScene) {

{


gdjs.MechanicsCode.userFunc0x75ec08(runtimeScene);

}


}; //End of gdjs.MechanicsCode.eventsList0x75eb84
gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDDoorwayObjects2Objects = Hashtable.newFrom({"Doorway": gdjs.MechanicsCode.GDDoorwayObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects = Hashtable.newFrom({"Sunlight": gdjs.MechanicsCode.GDSunlightObjects2});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDDoorwayObjects1Objects = Hashtable.newFrom({"Doorway": gdjs.MechanicsCode.GDDoorwayObjects1});gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects1Objects = Hashtable.newFrom({"Sunlight": gdjs.MechanicsCode.GDSunlightObjects1});gdjs.MechanicsCode.eventsList0x75ecec = function(runtimeScene) {

{

gdjs.MechanicsCode.GDDoorwayObjects2.createFrom(runtimeScene.getObjects("Doorway"));
gdjs.MechanicsCode.GDSunlightObjects2.createFrom(runtimeScene.getObjects("Sunlight"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDDoorwayObjects2Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects2Objects, true, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDDoorwayObjects2 */
{for(var i = 0, len = gdjs.MechanicsCode.GDDoorwayObjects2.length ;i < len;++i) {
    gdjs.MechanicsCode.GDDoorwayObjects2[i].setAnimation(0);
}
}}

}


{

gdjs.MechanicsCode.GDDoorwayObjects1.createFrom(runtimeScene.getObjects("Doorway"));
gdjs.MechanicsCode.GDSunlightObjects1.createFrom(runtimeScene.getObjects("Sunlight"));

gdjs.MechanicsCode.condition0IsTrue_0.val = false;
{
gdjs.MechanicsCode.condition0IsTrue_0.val = gdjs.evtTools.object.hitBoxesCollisionTest(gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDDoorwayObjects1Objects, gdjs.MechanicsCode.mapOfGDgdjs_46MechanicsCode_46GDSunlightObjects1Objects, false, runtimeScene, false);
}if (gdjs.MechanicsCode.condition0IsTrue_0.val) {
/* Reuse gdjs.MechanicsCode.GDDoorwayObjects1 */
{for(var i = 0, len = gdjs.MechanicsCode.GDDoorwayObjects1.length ;i < len;++i) {
    gdjs.MechanicsCode.GDDoorwayObjects1[i].setAnimation(1);
}
}}

}


}; //End of gdjs.MechanicsCode.eventsList0x75ecec
gdjs.MechanicsCode.eventsList0x5b6e18 = function(runtimeScene) {

{



}


{



}


{


gdjs.MechanicsCode.eventsList0x81572c(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x815f04(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x6d2ee4(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x6d3094(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x6c4b64(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x78cb1c(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x6a9d74(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x6aa01c(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x6bfdc4(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x75e6d4(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x75eb84(runtimeScene);
}


{


gdjs.MechanicsCode.eventsList0x75ecec(runtimeScene);
}


}; //End of gdjs.MechanicsCode.eventsList0x5b6e18


gdjs.MechanicsCode.func = function(runtimeScene) {
runtimeScene.getOnceTriggers().startNewFrame();

gdjs.MechanicsCode.GDSilverCountObjects1.length = 0;
gdjs.MechanicsCode.GDSilverCountObjects2.length = 0;
gdjs.MechanicsCode.GDSilverCountObjects3.length = 0;
gdjs.MechanicsCode.GDSilverCountObjects4.length = 0;
gdjs.MechanicsCode.GDDepthObjects1.length = 0;
gdjs.MechanicsCode.GDDepthObjects2.length = 0;
gdjs.MechanicsCode.GDDepthObjects3.length = 0;
gdjs.MechanicsCode.GDDepthObjects4.length = 0;
gdjs.MechanicsCode.GDForegroundObjects1.length = 0;
gdjs.MechanicsCode.GDForegroundObjects2.length = 0;
gdjs.MechanicsCode.GDForegroundObjects3.length = 0;
gdjs.MechanicsCode.GDForegroundObjects4.length = 0;
gdjs.MechanicsCode.GDMossObjects1.length = 0;
gdjs.MechanicsCode.GDMossObjects2.length = 0;
gdjs.MechanicsCode.GDMossObjects3.length = 0;
gdjs.MechanicsCode.GDMossObjects4.length = 0;
gdjs.MechanicsCode.GDGlassObjects1.length = 0;
gdjs.MechanicsCode.GDGlassObjects2.length = 0;
gdjs.MechanicsCode.GDGlassObjects3.length = 0;
gdjs.MechanicsCode.GDGlassObjects4.length = 0;
gdjs.MechanicsCode.GDLadderObjects1.length = 0;
gdjs.MechanicsCode.GDLadderObjects2.length = 0;
gdjs.MechanicsCode.GDLadderObjects3.length = 0;
gdjs.MechanicsCode.GDLadderObjects4.length = 0;
gdjs.MechanicsCode.GDDoorwayBackObjects1.length = 0;
gdjs.MechanicsCode.GDDoorwayBackObjects2.length = 0;
gdjs.MechanicsCode.GDDoorwayBackObjects3.length = 0;
gdjs.MechanicsCode.GDDoorwayBackObjects4.length = 0;
gdjs.MechanicsCode.GDDoorwayObjects1.length = 0;
gdjs.MechanicsCode.GDDoorwayObjects2.length = 0;
gdjs.MechanicsCode.GDDoorwayObjects3.length = 0;
gdjs.MechanicsCode.GDDoorwayObjects4.length = 0;
gdjs.MechanicsCode.GDDoorLightVerticalObjects1.length = 0;
gdjs.MechanicsCode.GDDoorLightVerticalObjects2.length = 0;
gdjs.MechanicsCode.GDDoorLightVerticalObjects3.length = 0;
gdjs.MechanicsCode.GDDoorLightVerticalObjects4.length = 0;
gdjs.MechanicsCode.GDDoorLightHorizontalObjects1.length = 0;
gdjs.MechanicsCode.GDDoorLightHorizontalObjects2.length = 0;
gdjs.MechanicsCode.GDDoorLightHorizontalObjects3.length = 0;
gdjs.MechanicsCode.GDDoorLightHorizontalObjects4.length = 0;
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects1.length = 0;
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects2.length = 0;
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects3.length = 0;
gdjs.MechanicsCode.GDDoorHeavyVerticalObjects4.length = 0;
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects1.length = 0;
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects2.length = 0;
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects3.length = 0;
gdjs.MechanicsCode.GDDoorHeavyHorizontalObjects4.length = 0;
gdjs.MechanicsCode.GDCrystalObjects1.length = 0;
gdjs.MechanicsCode.GDCrystalObjects2.length = 0;
gdjs.MechanicsCode.GDCrystalObjects3.length = 0;
gdjs.MechanicsCode.GDCrystalObjects4.length = 0;
gdjs.MechanicsCode.GDButtonObjects1.length = 0;
gdjs.MechanicsCode.GDButtonObjects2.length = 0;
gdjs.MechanicsCode.GDButtonObjects3.length = 0;
gdjs.MechanicsCode.GDButtonObjects4.length = 0;
gdjs.MechanicsCode.GDDarknessObjects1.length = 0;
gdjs.MechanicsCode.GDDarknessObjects2.length = 0;
gdjs.MechanicsCode.GDDarknessObjects3.length = 0;
gdjs.MechanicsCode.GDDarknessObjects4.length = 0;
gdjs.MechanicsCode.GDSunlightSourceObjects1.length = 0;
gdjs.MechanicsCode.GDSunlightSourceObjects2.length = 0;
gdjs.MechanicsCode.GDSunlightSourceObjects3.length = 0;
gdjs.MechanicsCode.GDSunlightSourceObjects4.length = 0;
gdjs.MechanicsCode.GDSunlightObjects1.length = 0;
gdjs.MechanicsCode.GDSunlightObjects2.length = 0;
gdjs.MechanicsCode.GDSunlightObjects3.length = 0;
gdjs.MechanicsCode.GDSunlightObjects4.length = 0;
gdjs.MechanicsCode.GDMirrorStaticObjects1.length = 0;
gdjs.MechanicsCode.GDMirrorStaticObjects2.length = 0;
gdjs.MechanicsCode.GDMirrorStaticObjects3.length = 0;
gdjs.MechanicsCode.GDMirrorStaticObjects4.length = 0;
gdjs.MechanicsCode.GDMirrorObjects1.length = 0;
gdjs.MechanicsCode.GDMirrorObjects2.length = 0;
gdjs.MechanicsCode.GDMirrorObjects3.length = 0;
gdjs.MechanicsCode.GDMirrorObjects4.length = 0;
gdjs.MechanicsCode.GDSphereStaticObjects1.length = 0;
gdjs.MechanicsCode.GDSphereStaticObjects2.length = 0;
gdjs.MechanicsCode.GDSphereStaticObjects3.length = 0;
gdjs.MechanicsCode.GDSphereStaticObjects4.length = 0;
gdjs.MechanicsCode.GDSphereObjects1.length = 0;
gdjs.MechanicsCode.GDSphereObjects2.length = 0;
gdjs.MechanicsCode.GDSphereObjects3.length = 0;
gdjs.MechanicsCode.GDSphereObjects4.length = 0;
gdjs.MechanicsCode.GDPlayerObjects1.length = 0;
gdjs.MechanicsCode.GDPlayerObjects2.length = 0;
gdjs.MechanicsCode.GDPlayerObjects3.length = 0;
gdjs.MechanicsCode.GDPlayerObjects4.length = 0;
gdjs.MechanicsCode.GDSilverObjects1.length = 0;
gdjs.MechanicsCode.GDSilverObjects2.length = 0;
gdjs.MechanicsCode.GDSilverObjects3.length = 0;
gdjs.MechanicsCode.GDSilverObjects4.length = 0;
gdjs.MechanicsCode.GDVampireObjects1.length = 0;
gdjs.MechanicsCode.GDVampireObjects2.length = 0;
gdjs.MechanicsCode.GDVampireObjects3.length = 0;
gdjs.MechanicsCode.GDVampireObjects4.length = 0;
gdjs.MechanicsCode.GDleftObjects1.length = 0;
gdjs.MechanicsCode.GDleftObjects2.length = 0;
gdjs.MechanicsCode.GDleftObjects3.length = 0;
gdjs.MechanicsCode.GDleftObjects4.length = 0;
gdjs.MechanicsCode.GDrightObjects1.length = 0;
gdjs.MechanicsCode.GDrightObjects2.length = 0;
gdjs.MechanicsCode.GDrightObjects3.length = 0;
gdjs.MechanicsCode.GDrightObjects4.length = 0;

gdjs.MechanicsCode.eventsList0x5b6e18(runtimeScene);
return;

}

gdjs['MechanicsCode'] = gdjs.MechanicsCode;
